<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="static/Icon.svg" type="image/svg+xml">

    <title>Gallery Home</title>
    
    
    <meta name="viewport" 
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<script>
document.addEventListener('keydown', function (e) {
    if (
        (e.ctrlKey || e.metaKey) &&
        ['+', '-', '=', '0'].includes(e.key)
    ) {
        e.preventDefault();
    }
});

document.addEventListener('wheel', function (e) {
    if (e.ctrlKey) {
        e.preventDefault();
    }
}, { passive: false });
</script>




    <style>
    html, body {
    touch-action: manipulation;
}
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: #f8f8f8;
            color: #333;
        }
        header {
        display: flex;align-items: center;
            font-weight: 600;
            z-index: 10;
        }

        .upload-box {

padding: 8px 16px calc(env(safe-area-inset-bottom) + 8px);
    height: 50px;
            border-bottom: 1px solid #ddd;
            text-align: center;
    display: flex;
    align-items: center;
    justify-content: space-between;
gap: 16px;
position: fixed;
    z-index: 10;
    width: -webkit-fill-available;
margin-top: -60px;

    
        background: rgb(255 255 255 / 50%);
    backdrop-filter: blur(20px);
        border-bottom-left-radius: 25px;
    border-bottom-right-radius: 25px;
        }
        
        
        .upload-box input[type="file"] {
            margin: 12px 0;
            cursor: pointer;
        }



        .controls {
    display: flex;
    align-items: center;
    width: 33%;
        }
        .btn {
            background: #007aff;
            color: white;
            border: none;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
border-radius: 10px;
    padding: 10px 10px;
display: flex;vertical-align: middle;

    /* Mobile-specific: remove tap highlight */
    -webkit-tap-highlight-color: transparent;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    
    
        }
        .radi {
        border-radius: 999999px;
        }
        
        .btn:hover {
            background: #005ecb;
        }
        .btn:disabled {
            background: #a0a0a0;
            cursor: not-allowed;
        }
        
        
        
.btn:focus,
.btn:active {
    outline: none;                 /* Remove outline if desired */
}

a {
    /* Mobile-specific: remove tap highlight */
    -webkit-tap-highlight-color: transparent;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    
    
        }

.upload-btn svg {
    display: flex;
    align-items: center;
    justify-content: center;
}


        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 8px;
            padding: 10px 12px;
    margin-top: 60px;
        }
        .gallery label.gallery-item {
            position: relative;
            display: block;
            border-radius: 8px;
            overflow: hidden;
            background: white;
            cursor: pointer;
        }
        .gallery img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            user-select: none;
            border-radius: 8px;
        }

        .gallery input[type="checkbox"] {
            display: none;
            position: absolute;
            top: 8px;
            left: 8px;
            width: 22px;
            height: 22px;
            border-radius: 5px;
            border: 2px solid #007aff;
            background: white;
        }
        .select-mode .gallery input[type="checkbox"] {
            display: block;
        }
        .gallery input[type="checkbox"]:checked {
            background: #007aff;
            border-color: #005ecb;
        }

        /* Lightbox styles */
        #lightboxOverlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            backdrop-filter: blur(10px);
            justify-content: center;
            align-items: center;
            z-index: 999;
                background-color: rgba(0, 0, 0, 0.2);
        }
        #lightboxOverlay.active {
            display: flex;
        }
        #lightboxOverlay img {
            max-width: 100vw;
            max-height: 80vh;
            transition: transform 0.3s ease;
            cursor: grab;
        }


        #closeBtn {
    z-index: 999999;
    font-size: x-large;
    width: auto;
    padding: 5px 12px;
    background-color: #ff2147;
}
        #prevBtn {    top: 50%;
    left: 0px;
    transform: translateY(-50%);
    z-index: 100;
    position: fixed;
    height: 100%;
    width: 50px;
    align-items: anchor-center;
    justify-content: right;
    border-radius: 0px;
    border-top-right-radius: 9999px;
    border-bottom-right-radius: 9999px;
    padding-right: 23px;
    }
    
    
        #nextBtn { 
    top: 50%;
    right: 0px;
    transform: translateY(-50%);
    z-index: 100;
    position: fixed;
    height: 100%;
    width: 50px;
    align-items: anchor-center;
    justify-content: left;
    border-radius: 0px;
    border-top-left-radius: 9999px;
    border-bottom-left-radius: 9999px;
    padding-left: 23px;
}
.switch {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 28px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  transition: 0.3s;
  border-radius: 34px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 22px;
  width: 22px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: 0.3s;
  border-radius: 50%;
}

input:checked + .slider {
  background-color: #4cd964; /* iOS green */
}

input:checked + .slider:before {
  transform: translateX(22px);
}
.slider.round {
  border-radius: 34px;
}
/* iOS-style floating action bar shown when items are selected */
.ios-action-bar {
  position: fixed;
  left: 0;
  right: 0;
  bottom: -1px;
  padding: 8px 16px calc(env(safe-area-inset-bottom) + 8px);
  background: rgb(255 255 255 / 50%);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-top: 1px solid rgba(0,0,0,0.1);
  display: none;            /* hidden by default */
  gap: 12px;
  justify-content: center;
  z-index: 2000;
    display: none;
    gap: 12px;
    justify-content: space-between;
    z-index: 2000;
    align-items: center;
height: 50px;
    border-top-left-radius: 25px;
    border-top-right-radius: 25px;
}

.ios-btn-pill {
  flex: 1;
  min-width: auto;
  padding: 14px 36px;
  font-size: 17px;
  font-weight: 600;
  line-height: 1;
  border: none;
  border-radius: 9999px;    /* full pill */
  cursor: pointer;
  transition: transform 0.08s ease, opacity 0.08s ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}




#lightboxImage {
  transition: transform 0.2s ease;
  touch-action: none; /* Prevent default scrolling while touching image */
  cursor: grab;
}
#lightboxImage:active {
  cursor: grabbing;
}
/* Modal background */
  .modal-bg {
    display: none; /* hidden by default */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.2);
    z-index: 32000;
    justify-content: center;
    align-items: flex-start; /* start from top */
    backdrop-filter: blur(10px);
        transition: opacity 0.3s ease;
}

/* Modal box */
.modal {
  width: -webkit-fill-available;
  background-color: white;
  border-top-left-radius: 25px;
  border-top-right-radius: 25px;
  padding: 20px;
  position: absolute;
  bottom: 0;
  transform: translateY(100%);
  animation: slideUp 0.3s ease forwards;
}

/* OPEN animation (bottom → up) */
@keyframes slideUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}

/* CLOSE animation (up → bottom) */
@keyframes slideDown {
  from {
    transform: translateY(0);
  }
  to {
    transform: translateY(100%);
  }
}

/* Apply when closing */
.modal.closing {
  animation: slideDown 0.3s ease forwards;
}






  /* Close button */
  .close-btn {
    font-size: 20px;
    padding: 5px 10px;
    background-color: #ff2147;
    cursor: pointer;
  }
  .close-btn:hover {
  background-color: red;
  }
    </style>
</head>



<style>

    /* Blur layer (NOT the body itself) */
    body::before {
        content: "";
        position: fixed;
        inset: 0;
        backdrop-filter: blur(10px);
        background: rgba(0,0,0,0.2);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        z-index: 2500;
    }

    body.blur::before {
        opacity: 1;
        pointer-events: auto;
    }

    /* Sidebar */
    #sidebar {
        position: fixed;
        top: 0;
        left: -280px;
        width: 280px;
        height: 100%;
        background: #111;
        color: white;
        padding: 20px;
        box-sizing: border-box;
        transition: left 0.3s ease;
        z-index: 3000;
        touch-action: none;
            backdrop-filter: blur(10px);
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
    border-bottom-right-radius: 25px;
    border-top-right-radius: 25px;
    }

    #sidebar.active {
        left: 0;
    }

    #sidebar a {
        display: flex;
        color: white;
        text-decoration: none;
            font-size: 18px;
    padding: 10px;
    padding-top: 15px;
    padding-bottom: 15px;
    border-radius: 10px;
        justify-content: space-between;
    align-items: center;
    }

    #sidebar a:hover {
        color: #ccc;
    }


</style>


<body>

<div id="sidebar">



<div style="
    display: flex;
    align-items: center;
    justify-content: space-between;
">
<h2 style="
    padding: unset !important;
    margin: unset;
"><a href="{{ url_for('index') }}" style="padding: 0px;">Album's</a></h2>

<div style="
    display: flex;
    flex-direction: row-reverse;
">
    <button class="close-btn btn radi" onclick="closeSidebar()" style="
    font-size: x-large;
    width: 45px;
    height: 45px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: xx-large;
">×</button>
     &nbsp;
     <button class="btn" onclick="openModal('AddNewAlbum');closeSidebar()" type="button" style="padding: 0px;background: unset;">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="45" height="45" x="0" y="0" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path fill="#2196f3" fill-rule="evenodd" d="M256 511.44c140.724 0 255.5-114.655 255.5-255.379S396.724.56 256 .56.5 115.336.5 256.06 115.276 511.44 256 511.44z" clip-rule="evenodd" opacity="1" data-original="#2196f3"></path><path fill="#ffffff" d="M405.379 178.616v154.768c0 54.497-44.337 98.833-98.833 98.833H205.455c-54.497 0-98.833-44.337-98.833-98.833a8.607 8.607 0 0 1 8.604-8.604c4.756 0 8.611 3.855 8.611 8.604 0 45.004 36.613 81.625 81.618 81.625h101.091c45.004 0 81.618-36.62 81.618-81.625V187.021h-36.599c-29.571 0-53.623-24.051-53.623-53.616V96.991h-92.487c-45.004 0-81.618 36.62-81.618 81.625v123.82a8.61 8.61 0 0 1-8.611 8.611c-4.75 0-8.604-3.855-8.604-8.611v-123.82c0-54.497 44.337-98.833 98.833-98.833h101.091a8.61 8.61 0 0 1 6.085 2.519l90.222 90.229a8.586 8.586 0 0 1 2.526 6.085zm-149.386 30.122a8.61 8.61 0 0 0-8.611 8.611v52.507h-52.507a8.603 8.603 0 0 0-8.604 8.604 8.607 8.607 0 0 0 8.604 8.604h52.507v52.528c0 4.75 3.855 8.604 8.611 8.604a8.607 8.607 0 0 0 8.604-8.604v-52.528h52.528a8.607 8.607 0 0 0 8.604-8.604 8.603 8.603 0 0 0-8.604-8.604h-52.528v-52.507c0-4.756-3.854-8.611-8.604-8.611z" opacity="1" data-original="#ffffff"></path></g></svg>
</button>
</div>
 </div>
 
    
    
    <div style="height: -webkit-fill-available;overflow-inline: auto;margin-top: 15px;">
{% for name, info in albums.items() %}
        <a href="{{ url_for('index', album=name) }}" class="" style="border: 1px solid #cccccc57;margin-bottom: 15px;{% if name == current_album %}backdrop-filter: contrast(0.5);{% endif %}">
            <div>{{ name }} <br><sub style="font-size: x-small;">{{ info.file_count }} IMG</sub></div>
            <div style="font-size: medium;">{{info.size_human}}</div>
        </a>
    {% endfor %}
    </div>
    
    <a href="{{ url_for('logout') }}" class="" style="border: 1px solid #ff214757;margin-bottom: 15px;color: #ff2147;backdrop-filter: contrast(0.5);justify-content: flex-start;">
            <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" x="0" y="0" viewBox="0 0 64 64" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g transform="matrix(1.0799999999999994,0,0,1.0799999999999994,-2.5559093093871894,-2.5551998901366986)"><g data-name="Layer 20"><path d="M52.62 14.37a4.59 4.59 0 0 0-3.51-1.47 4.67 4.67 0 0 0-3.47 1.69 4.65 4.65 0 0 0 .19 6.07 18.78 18.78 0 0 1-15.49 31.46 18.77 18.77 0 0 1-12.13-31.44 4.65 4.65 0 0 0-3.31-7.78 4.56 4.56 0 0 0-3.53 1.48 28 28 0 0 0-7.16 23 28.3 28.3 0 0 0 26.73 24h1.07a28.07 28.07 0 0 0 20.61-47.01z" fill="#ff2147" opacity="1" data-original="#000000" class=""></path><path d="M32 34.92a4.65 4.65 0 0 0 4.65-4.65V7.15a4.65 4.65 0 0 0-9.3 0v23.12A4.65 4.65 0 0 0 32 34.92z" fill="#ff2147" opacity="1" data-original="#000000" class=""></path></g></g></svg>  &nbsp;Logout
        </a>
        
    
   <v  style="margin-top: 15px;">Totalling <b>{{size_unt}}</b></v>
   <v  style="">Free Space <b>{{free_gb}} GB</b></v>

<div class="bar-containeralbum" style="height: 10px;margin-top: 5px;">
  <div class="bar-photoalbum" style="width: calc({{size_gb}}/ {{free_gb}} * 100%);background-color: green;"></div>
</div>



</div>

<script>
    const sidebar = document.getElementById("sidebar");

    function openSidebar() {
        sidebar.classList.add("active");
        document.body.classList.add("blur");
        
        
    }

    function closeSidebar() {
        sidebar.classList.remove("active");
        document.body.classList.remove("blur");
    }

</script>





<body id="body">




<div class="upload-box">


<div class="controls">
    <button onclick="openSidebar()" class="btn radi"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" x="0" y="0" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="M313.213 241H512V55c0-30.327-24.673-55-55-55H230v512h227c30.327 0 55-24.673 55-55V271H313.213l24.394 24.394c5.858 5.858 5.858 15.355 0 21.213s-15.355 5.858-21.213 0l-50-50c-5.858-5.858-5.858-15.355 0-21.213l50-50c5.858-5.858 15.355-5.858 21.213 0s5.858 15.355 0 21.213zM0 55v402c0 30.327 24.673 55 55 55h145V0H55C24.673 0 0 24.673 0 55zm140 155H60c-8.284 0-15-6.716-15-15s6.716-15 15-15h80c8.284 0 15 6.716 15 15s-6.716 15-15 15zm0-60H60c-8.284 0-15-6.716-15-15s6.716-15 15-15h80c8.284 0 15 6.716 15 15s-6.716 15-15 15zm0-90c8.284 0 15 6.716 15 15s-6.716 15-15 15H60c-8.284 0-15-6.716-15-15s6.716-15 15-15z" fill="#ffffff" opacity="1" data-original="#000000" class=""></path></g></svg></button>

 
 &nbsp;
 
<form method="POST" enctype="multipart/form-data" class="upload-form" id="uploadForm">
  <label for="fileUpload" class="btn radi">
   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 489.4 489.4" width="25" height="25">
            <g>
                <path d="M382.4 422.75H277.4v-106.1h34.7c8.8 0 14-10 8.8-17.2l-67.5-93.4c-4.3-6-13.2-6-17.5 0l-67.5 93.4c-5.2 7.2-.1 17.2 8.8 17.2h34.7v106.1H94.3c-52.5-2.9-94.3-52-94.3-105.2 0-36.7 19.9-68.7 49.4-86-2.7-7.3-4.1-15.1-4.1-23.3 0-37.5 30.3-67.8 67.8-67.8 8.1 0 15.9 1.4 23.2 4.1 21.7-46 68.5-77.9 122.9-77.9 70.4.1 128.4 54 135 122.7 54.1 9.3 95.2 59.4 95.2 116.1 0 60.6-47.2 113.1-107 117.3z" fill="#ffffff"></path>
            </g>
        </svg>
  </label>
<input id="fileUpload" type="file" name="file" multiple accept="image/*,video/*" hidden>
  <input type="hidden" id="album" name="album" value="{{ current_album }}">
</form>
</div>











<header style="display: flex;align-items: center;width: 33%;">

<img src="static/Icon.svg" width="50px">&nbsp;
<div style="display: flex;flex-direction: column;align-items: flex-start;width: 80%;">
<v style="
    width: 100%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: -webkit-left;
">{% if not current_album %}
    Gallery
{% else %}
    {{ current_album }}
{% endif %}</v>
<sub style="font-size: small;">{{ total_images }} IMG</sub>
</div>
</header>






    <div class="controls" style="justify-content: right;">
    {% if images %}
        <button id="toggleSelectBtn" type="button" class="btn radi"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" x="0" y="0" viewBox="0 0 682.667 682.667" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><defs><clipPath id="a" clipPathUnits="userSpaceOnUse"><path d="M0 512h512V0H0Z" fill="#fff" opacity="1" data-original="#fff"></path></clipPath></defs><g clip-path="url(#a)" transform="matrix(1.33333 0 0 -1.33333 0 682.667)"><path d="M0 0c6.582 11.096 10.361 24.05 10.361 37.886 0 41.069-33.293 74.362-74.362 74.362" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(319.971 296.188)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c-6.582 11.096-10.361 24.05-10.361 37.886 0 41.069 33.294 74.362 74.362 74.362" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(191.968 296.188)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c11.242 18.382 17.721 39.993 17.721 63.118 0 46.946-26.702 87.655-65.747 107.769" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(359.4 270.956)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c19.315 41.268 61.212 69.855 109.787 69.855" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(146.183 385.37)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c0-44.343 23.822-83.121 59.367-104.235" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(134.819 334.074)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c-8.087-19.673-12.546-41.22-12.546-63.809 0-45.736 18.282-87.202 47.938-117.488" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(100.577 397.883)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c-30.208 44.492-81.211 73.723-139.042 73.723-37.824 0-72.727-12.504-100.802-33.604" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(395.012 428.291)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c9.021 20.602 14.025 43.363 14.025 67.293 0 17.391-2.643 34.164-7.55 49.94" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(409.884 266.781)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v189.409c0 13.255 10.746 24 24 24v0c13.255 0 24-10.745 24-24V3.408" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(231.97 144.237)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v24.52c0 13.254 10.746 24 24 24v0c13.255 0 24-10.746 24-24V0" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(279.97 147.645)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v14.282c0 13.255 10.746 24 24 24v0c13.255 0 24-10.745 24-24V0" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(327.97 147.645)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v.52c0 13.254 10.746 24 24 24 13.255 0 24-10.746 24-24v-21.628" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(375.97 147.645)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v-53.404a95.071 95.071 0 0 0-24-63.147" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(423.97 126.537)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v-67.477c0-24.37 8.486-47.98 24-66.774" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(231.97 144.237)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="m0 0-63.784 110.476c-6.97 12.073-2.833 27.511 9.24 34.482s27.512 2.834 34.482-9.239l15.627-27.068" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(236.098 47.32)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v0" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(123.128 436.818)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path></g></g></svg></button>
 
 &nbsp;
{% endif %}


<button onclick="openModal('infoAlbum')" type="button" class="btn radi" style="background: teal;">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" x="0" y="0" viewBox="0 0 111.577 111.577" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="m78.962 99.536-1.559 6.373c-4.677 1.846-8.413 3.251-11.195 4.217-2.785.969-6.021 1.451-9.708 1.451-5.662 0-10.066-1.387-13.207-4.142-3.141-2.766-4.712-6.271-4.712-10.523 0-1.646.114-3.339.351-5.064.239-1.727.619-3.672 1.139-5.846l5.845-20.688c.52-1.981.962-3.858 1.316-5.633.359-1.764.532-3.387.532-4.848 0-2.642-.547-4.49-1.636-5.529-1.089-1.036-3.167-1.562-6.252-1.562-1.511 0-3.064.242-4.647.71-1.59.47-2.949.924-4.09 1.346l1.563-6.378c3.829-1.559 7.489-2.894 10.99-4.002 3.501-1.111 6.809-1.667 9.938-1.667 5.623 0 9.962 1.359 13.009 4.077 3.047 2.72 4.57 6.246 4.57 10.591 0 .899-.1 2.483-.315 4.747-.21 2.269-.601 4.348-1.171 6.239l-5.82 20.605c-.477 1.655-.906 3.547-1.279 5.676-.385 2.115-.569 3.731-.569 4.815 0 2.736.61 4.604 1.833 5.597 1.232.993 3.354 1.487 6.368 1.487 1.415 0 3.025-.251 4.814-.744 1.784-.493 3.085-.926 3.892-1.305zm1.476-86.506c0 3.59-1.353 6.656-4.072 9.177-2.712 2.53-5.98 3.796-9.803 3.796-3.835 0-7.111-1.266-9.854-3.796-2.738-2.522-4.11-5.587-4.11-9.177 0-3.583 1.372-6.654 4.11-9.207C59.447 1.274 62.729 0 66.563 0c3.822 0 7.091 1.277 9.803 3.823 2.721 2.553 4.072 5.625 4.072 9.207z" fill="#ffffff" opacity="1" data-original="#000000" class=""></path></g></svg>
</button>

    </div>


</div>







<!-- Progress UI -->
<div id="uploadStatus" style="position: fixed;height: 100vh;width: -webkit-fill-available;z-index: 2147483647;display: none;bottom: 0px;margin-left: -15px;padding: 0px;align-content: center;padding: 30px;backdrop-filter: blur(5px);background: rgb(0 0 0 / 0.2);">
  <div id="statusText" style="
    font-weight: bold;
    font-size: larger;
    backdrop-filter: drop-shadow(2px 4px 6px black);
    padding: 5px;
    border-radius: 5px;
    color: #fff;
">Preparing upload...</div>
  <div style="width:100%;background:#ddd;height: 15px;border-radius:5px;margin-top: 5px;">
    <div id="progressBar" style="width:0%; height:100%; background:#4caf50; border-radius:5px;"></div>
  </div>
</div>
<script>
const fileInput = document.getElementById('fileUpload');
const statusBox = document.getElementById('uploadStatus');
const statusText = document.getElementById('statusText');
const progressBar = document.getElementById('progressBar');


const album = document.getElementById('album').value || "Default";

fileInput.addEventListener('change', async () => {
  const files = Array.from(fileInput.files);
  if (files.length === 0) return;

  if (!confirm(`Upload ${files.length} image(s) one by one?`)) {
    fileInput.value = "";
    return;
  }

  statusBox.style.display = "block";

  for (let i = 0; i < files.length; i++) {
    const file = files[i];
    statusText.innerText = `Uploading ${i + 1} of ${files.length}: ${file.name}`;

    await uploadSingleFile(file);

    const percent = Math.round(((i + 1) / files.length) * 100);
    progressBar.style.width = percent + "%";
  }

  statusText.innerText = "✅ Upload finished";
  fileInput.value = "";
  statusBox.style.display = "none";
  location.reload();
});

// Upload ONE file
async function uploadSingleFile(file) {
  const formData = new FormData();
  formData.append("file", file);
  formData.append('album', album);

  const response = await fetch("/upload", {
    method: "POST",
    body: formData
  });

  if (!response.ok) {
    //alert("Upload failed for " + file.name);
  }
}
</script>














<!-- Floating iOS-style action bar -->
<div class="ios-action-bar" aria-hidden="true" id="selectBar">

<div style="display: flex;align-items: center;">
<label class="switch">
  <input type="checkbox" id="selectAllCheckbox">
  <span class="slider round"></span>
</label>
<span style="margin-left:10px;" for="selectAllCheckbox">Select All</span>
</div>

<form id="downloadForm" method="POST">
<div id="deletbar" style="display:none;">

  <!-- Download -->
  <button type="button" 
  onclick="openModal('MoveSelected')"
          class="btn radi"
         >
    <!-- icon -->
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" x="0" y="0" viewBox="0 0 513 513" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="M146 267.519H80c-33.137 0-60-26.863-60-60V70.482c0-27.614 22.386-50 50-50h42.912c27.64 0 50.024 22.448 49.944 50.088v0H226c33.137 0 60 26.863 60 60v35.912m-59 137v-8c0-27.614 22.386-50 50-50h42.912c27.64 0 50.024 22.448 49.944 50.088v0H433c33.137 0 60 26.863 60 60v76.928c0 33.131-26.853 59.991-59.984 60l-100.016.02m-99-.036 26.289-26.166c15.615-15.567 15.615-40.806 0-56.373L234 384.482m-154-39v41c0 27.614 22.386 50 50 50h63" style="stroke-width:40;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" fill="none" stroke="#ffffff" stroke-width="40" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" data-original="#000000" opacity="1"></path></g></svg>
  
  </button>
  
 


  
  
&nbsp; 



  <!-- Download -->
  <button type="submit" 
          formaction="{{ url_for('download') }}"
          class="btn radi"
         >
    <!-- icon -->
    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 128 128">
      <path d="M128 65c0 15.439-12.563 28-28 28H80c-2.211 0-4-1.791-4-4s1.789-4 4-4h20c11.027 0 20-8.973 20-20s-8.973-20-20-20h-4c-2.211 0-4-1.791-4-4 0-15.439-12.563-28-28-28S36 25.561 36 41c0 2.209-1.789 4-4 4h-4C16.973 45 8 53.973 8 65s8.973 20 20 20h20c2.211 0 4 1.791 4 4s-1.789 4-4 4H28C12.563 93 0 80.439 0 65s12.563-28 28-28h.223C30.219 19.025 45.5 5 64 5s33.781 14.025 35.777 32H100c15.438 0 28 12.561 28 28zm-50.828 37.172L68 111.344V61c0-2.209-1.789-4-4-4s-4 1.791-4 4v50.344l-9.172-9.172c-1.563-1.563-4.094-1.563-5.656 0s-1.563 4.094 0 5.656l16 16c.781.781 1.805 1.172 2.828 1.172s2.047-.391 2.828-1.172l16-16c1.563-1.563 1.563-4.094 0-5.656s-4.094-1.563-5.656 0z" fill="currentColor"/>
    </svg>
  
  </button>
&nbsp;  <!-- Delete -->
  <button type="submit"
          formaction="{{ url_for('DeletSelected') }}"
          class="btn radi" style="background: #ff2147;"
          onclick="return confirm('Are you sure you want to delete the selected images? This action cannot be undone.');"
>
    <!-- icon -->
    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 512 512">
      <path d="m62.205 150 26.569 320.735C90.678 493.865 110.38 512 133.598 512h244.805c23.218 0 42.92-18.135 44.824-41.265L449.795 150H62.205zm118.781 302c-7.852 0-14.458-6.108-14.956-14.063l-15-242c-.513-8.276 5.771-15.395 14.033-15.908 8.569-.601 15.381 5.757 15.908 14.033l15 242c.531 8.57-6.25 15.938-14.985 15.938zM271 437c0 8.291-6.709 15-15 15s-15-6.709-15-15V195c0-8.291 6.709-15 15-15s15 6.709 15 15v242zm89.97-241.062-15 242c-.493 7.874-7.056 14.436-15.908 14.033-8.262-.513-14.546-7.632-14.033-15.908l15-242c.513-8.276 7.764-14.297 15.908-14.033 8.262.513 14.546 7.632 14.033 15.908zM451 60h-90V45c0-24.814-20.186-45-45-45H196c-24.814 0-45 20.186-45 45v15H61c-16.569 0-30 13.431-30 30 0 16.567 13.431 30 30 30h390c16.569 0 30-13.433 30-30 0-16.569-13.431-30-30-30zm-120 0H181V45c0-8.276 6.724-15 15-15h120c8.276 0 15 6.724 15 15v15z" fill="currentColor"/>
    </svg> </button>
</div>

<input type="hidden" name="album" value="{{ current_album }}">

</form>

</div>












<div class="gallery">
{% if images %}
    {% for img in images %}
        <label class="gallery-item" style="position: relative; display: inline-block;"  onclick="openLightbox('static/Uploads/{{ img.album }}/{{ img.filename }}',{{ 'true' if img.is_video else 'false' }})">
            <input type="checkbox" name="selected_images" form="downloadForm" value="{{ img.album }}/{{ img.filename }}">
            
            {% if img.is_video %}
                <!-- Show video thumbnail -->
                <img src="{{ url_for('static', filename=img.thumbnail) }}" alt="Video">
                <!-- Play overlay -->
                <span style="position: absolute; top: calc(50% - 25px); left:calc(50% - 25px); color: white; font-weight: bold;
                             background: rgba(0,0,0,0.5); padding: 2px 4px; border-radius: 3px;    display: flex;
    align-items: center;
    justify-content: center;
    padding: 10px;"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30" x="0" y="0" viewBox="0 0 163.861 163.861" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="M34.857 3.613C20.084-4.861 8.107 2.081 8.107 19.106v125.637c0 17.042 11.977 23.975 26.75 15.509L144.67 97.275c14.778-8.477 14.778-22.211 0-30.686L34.857 3.613z" fill="#ffffff" opacity="1" data-original="#000000" class=""></path></g></svg></span>
            {% else %}
                <!-- Show normal image -->
                <img src="{{ url_for('static', filename='Uploads/' + img.album + '/' + img.filename) }}" alt="Image">
            {% endif %}
        </label>
    {% endfor %}
    {% else %}
        <img src="static/no-foto.webp" style="
    position: absolute;
    width: 90%;
    height: 83vh;
    place-self: anchor-center;
">
    {% endif %}
</div>






<!-- Lightbox -->
<div id="lightboxOverlay">


<div style="position: fixed;top: 13px;max-width: -webkit-fill-available;display: flex;align-items: center;justify-content: space-between;margin: 0px 19px;width: -webkit-fill-available;">
<v id="nameIMG" style="
    width: calc(100% - 100px);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: -webkit-left;
    font-weight: bold;
    color: #fff;
    display: flex;
    align-items: center;
"></v>
<button id="closeBtn" class="btn radi" aria-label="Close">&times;</button>
</div>


    <div style="position:relative; text-align:center;">




<img id="lightboxImage" src="" alt="Fullscreen Image">

<video id="lightboxVideo"
       controls
       style="display:none; max-width:100%;"
></video>


<!-- New buttons below the image -->
<div class="ios-action-bar" style="margin-top:10px; display:flex; justify-content:center; gap:12px;">


    <button id="prevBtn" class="btn radi" >&#9664;</button>


    
    
<button id="downloadSingleBtn" class="btn radi" style="padding:10px 10px; font-size:16px;"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 128 128">
      <path d="M128 65c0 15.439-12.563 28-28 28H80c-2.211 0-4-1.791-4-4s1.789-4 4-4h20c11.027 0 20-8.973 20-20s-8.973-20-20-20h-4c-2.211 0-4-1.791-4-4 0-15.439-12.563-28-28-28S36 25.561 36 41c0 2.209-1.789 4-4 4h-4C16.973 45 8 53.973 8 65s8.973 20 20 20h20c2.211 0 4 1.791 4 4s-1.789 4-4 4H28C12.563 93 0 80.439 0 65s12.563-28 28-28h.223C30.219 19.025 45.5 5 64 5s33.781 14.025 35.777 32H100c15.438 0 28 12.561 28 28zm-50.828 37.172L68 111.344V61c0-2.209-1.789-4-4-4s-4 1.791-4 4v50.344l-9.172-9.172c-1.563-1.563-4.094-1.563-5.656 0s-1.563 4.094 0 5.656l16 16c.781.781 1.805 1.172 2.828 1.172s2.047-.391 2.828-1.172l16-16c1.563-1.563 1.563-4.094 0-5.656s-4.094-1.563-5.656 0z" fill="currentColor"></path>
    </svg></button>

<button id="shareBtn" class="btn radi" style="padding:10px 10px; font-size:16px;background: limegreen;"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" x="0" y="0" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="M271.176 121.396C120.971 129.218.176 253.891.176 406v106l37.925-88.29c44.854-89.692 133.847-147.041 233.075-152.314v121.318L511.824 196 271.176 0z" fill="#ffffff" opacity="1" data-original="#000000"></path></g></svg></button>


    <button id="nextBtn" class="btn radi">&#9654;</button>




  <!-- Delete Button -->
    <form id="deleteForm" method="POST" action="/DeletImage">
        <input type="hidden" name="imagName" id="imagName" value="">

        <button type="submit" class="btn radi" style=" background:#ff2147; color:white;padding:10px 10px;"
 onclick="return confirm('Are you sure you want to delete the selected images? This action cannot be undone.');"
>
    <!-- icon -->
    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 512 512">
      <path d="m62.205 150 26.569 320.735C90.678 493.865 110.38 512 133.598 512h244.805c23.218 0 42.92-18.135 44.824-41.265L449.795 150H62.205zm118.781 302c-7.852 0-14.458-6.108-14.956-14.063l-15-242c-.513-8.276 5.771-15.395 14.033-15.908 8.569-.601 15.381 5.757 15.908 14.033l15 242c.531 8.57-6.25 15.938-14.985 15.938zM271 437c0 8.291-6.709 15-15 15s-15-6.709-15-15V195c0-8.291 6.709-15 15-15s15 6.709 15 15v242zm89.97-241.062-15 242c-.493 7.874-7.056 14.436-15.908 14.033-8.262-.513-14.546-7.632-14.033-15.908l15-242c.513-8.276 7.764-14.297 15.908-14.033 8.262.513 14.546 7.632 14.033 15.908zM451 60h-90V45c0-24.814-20.186-45-45-45H196c-24.814 0-45 20.186-45 45v15H61c-16.569 0-30 13.431-30 30 0 16.567 13.431 30 30 30h390c16.569 0 30-13.433 30-30 0-16.569-13.431-30-30-30zm-120 0H181V45c0-8.276 6.724-15 15-15h120c8.276 0 15 6.724 15 15v15z" fill="currentColor"/>
    </svg> </button>
</form>


</div>

</div>

</div>











<div class="modal-bg" id="MoveSelected">
  <div class="modal">
<div style="
    display: flex;
    align-items: center;
    justify-content: space-between;
">
    <h2 style="margin: 0px;margin: 0px;display: flex;align-items: center;"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" x="0" y="0" viewBox="0 0 513 513" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="M146 267.519H80c-33.137 0-60-26.863-60-60V70.482c0-27.614 22.386-50 50-50h42.912c27.64 0 50.024 22.448 49.944 50.088v0H226c33.137 0 60 26.863 60 60v35.912m-59 137v-8c0-27.614 22.386-50 50-50h42.912c27.64 0 50.024 22.448 49.944 50.088v0H433c33.137 0 60 26.863 60 60v76.928c0 33.131-26.853 59.991-59.984 60l-100.016.02m-99-.036 26.289-26.166c15.615-15.567 15.615-40.806 0-56.373L234 384.482m-154-39v41c0 27.614 22.386 50 50 50h63" style="stroke-width:40;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" fill="none" stroke="#000" stroke-width="40" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" data-original="#000" opacity="1"></path></g></svg>&nbsp;Move Selected To</h2>
    <span class="close-btn btn radi" onclick="closeModal(this)">&times;</span>
    </div>
  
  
  
  <select name="choice" id="targetAlbum" style="
    width: 100%;
    padding: 8px;
    margin: 8px 0;
    box-sizing: border-box;
    border-radius: 10px;
    width: 100%;
    padding: 12px 12px 12px 12px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 16px;
    transition: all 0.3s ease;
    outline: none;    
">
  <option value="">Select one</option>
{% for name, info in albums.items() %}
  <option value="{{ name }}">{{ name }} ( {{info.file_count}} IMG )</option>   
    {% endfor %}
</select>

  <button  class="btn" style="float: right;" onclick="moveSelected()">Move</button>


</div>
</div>
<script>
function moveSelected() {
  const select = document.getElementById('targetAlbum');
  const targetAlbum = select.value;

  if (!targetAlbum) {
    alert('Please select an album');
    return;
  }

  const formData = new FormData();

  // REQUIRED fields expected by Flask
  formData.append('target_album', targetAlbum);

  // add selected images (checkboxes)
  document.querySelectorAll('input[name="selected_images"]:checked')
    .forEach(cb => formData.append('selected_images', cb.value));

  fetch("{{ url_for('MoveSelected') }}", {
    method: 'POST',
    body: formData
  }).then(() => {
    window.location.reload(); // or redirect if you want
  });
}
</script>
























<div class="modal-bg" id="AddNewAlbum">
  <div class="modal">
<div style="
    display: flex;
    align-items: center;
    justify-content: space-between;
">
    <h2 style="margin: 0px;margin: 0px;display: flex;align-items: center;">Add New Album</h2>
    <span class="close-btn btn radi" onclick="closeModal(this)">&times;</span>
    </div>
    
<form method="GET" onsubmit="return createAlbum()">
  <input type="text" id="newAlbum" placeholder="New album name" style="
    width: 100%;
    padding: 8px;
    margin: 8px 0;
    box-sizing: border-box;
    border-radius: 10px;
    width: 100%;
    padding: 12px 12px 12px 12px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 16px;
    transition: all 0.3s ease;
    outline: none;    
">
  <button class="btn" style="float: right;">Add Album</button>
</form>

<script>
function createAlbum() {
  const name = document.getElementById('newAlbum').value.trim();
  if (!name) return false;
  window.location = `/?album=${encodeURIComponent(name)}`;
  return false;
}
</script>

  </div>
</div>


















<div class="modal-bg" id="infoAlbum">
  <div class="modal">
<div style="
    display: flex;
    align-items: center;
    justify-content: space-between;
">
    <h2 style="margin: 0px;margin: 0px;display: flex;align-items: center;">Album info</h2>
    <span class="close-btn btn radi" onclick="closeModal(this)">&times;</span>
    </div>
    
    <br>
    Name : <v id="AlbumName"><b>{% if not current_album %}
    Gallery
{% else %}
{{ current_album }}
{% endif %}</b></v><br>
   
   
   
   

   
   
   
{% if current_album %}
Creation Date : <v id="AlbumSize"><b>
    {{ albums[current_album]['created_time'] if current_album in albums else 'N/A' }}
    </b></v><br>
{% endif %}


<hr style="border: 1px solid #ddd;margin-top: 1em;margin-bottom: 1em;">




<style>
  .bar-containeralbum {
    width: 100%;
    height: 25px;
    border-radius: 12px;
    overflow: hidden;
    display: flex;
        background-color: #e0e0e0;

  }
 
  .bar-photoalbum {
    background-color: #2196f3; /* blue */
    height: 100%;
  }
  .bar-videoalbum {
    background-color: #ff9800; /* orange */
    height: 100%;
  }
  .labelalbum {
    margin-top: 10px;
  }
</style>


<h3 style="margin-bottom: 10px;margin-top: 10px;">Storage Usage</h3>
<div class="bar-containeralbum">
  <div class="bar-photoalbum" style="width: calc({% if not current_album %}
    {{ albums.values() | map(attribute='photo_count') | sum if albums is defined else 0 }}
{% else %}
    {{ albums[current_album]['photo_count'] if current_album in albums else '0' }}
{% endif %} / {{total_images}} * 100%);"></div>
  <div class="bar-videoalbum" style="width: calc({% if not current_album %}
    {{ albums.values() | map(attribute='video_count') | sum if albums is defined else 0 }}
{% else %}
    {{ albums[current_album]['video_count'] if current_album in albums else '0' }}
{% endif %} / {{total_images}} * 100%);"></div>
</div>

<div class="labelalbum">
  <span style="color:#2196f3"><b>Photos : {% if not current_album %}
{{ albums.values() | map(attribute='photo_count') | sum if albums is defined else 0 }}

{% else %}
    {{ albums[current_album]['photo_count'] if current_album in albums else '0' }}
{% endif %}</span></b> |
  <span style="color:#ff9800"><b>Video : {% if not current_album %}
{{ albums.values() | map(attribute='video_count') | sum if albums is defined else 0 }}

{% else %}
    {{ albums[current_album]['video_count'] if current_album in albums else '0' }}
{% endif %}</span></b> |
  Total Size : <b>{% if not current_album %}
    {{ size_unt if size_unt is defined else '0' }}
{% else %}
    {{ albums[current_album]['size_human'] if current_album in albums else '0' }}
{% endif %}</b>
</div>




    Total Files : <v id="TotalImages"><b>{{ total_images }} Files</b></v><br>



{% if current_album %}
<hr style="border: 1px solid #ddd;margin-top: 1em;margin-bottom: 1em;">

<form method="POST" action="/change_name">

  <input type="hidden" id="old_name" name="old_name" placeholder="Current folder name" value="{{ current_album }}" required>

  <label for="new_name">Rename Album : </label>
  <input type="text" id="new_name" name="new_name" placeholder="New folder name" style="
    width: 100%;
    padding: 8px;
    margin: 8px 0;
    box-sizing: border-box;
    border-radius: 10px;
    width: 100%;
    padding: 12px 12px 12px 12px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 16px;
    transition: all 0.3s ease;
    outline: none;    
" required>

  <button type="submit" class="btn" style="justify-self: right;">Rename Album</button>
</form>
   
   
   
    
{% endif %}



  </div>
</div>






















<script>
function openModal(modalId) {
  const modal = document.getElementById(modalId);
  if (modal) modal.style.display = 'flex';
}

function closeModal(el) {
  const modalBg = el.closest('.modal-bg');
  const modal = modalBg.querySelector('.modal');

  modal.classList.add('closing');

  setTimeout(() => {
    modalBg.style.display = 'none';
    modal.classList.remove('closing');
    document.body.classList.remove("blur");
  }, 400);
}


window.addEventListener('click', e => {
  document.querySelectorAll('.modal-bg').forEach(bg => {
    if (e.target === bg) {
      const modal = bg.querySelector('.modal');
      modal.classList.add('closing');

      setTimeout(() => {
        bg.style.display = 'none';
        modal.classList.remove('closing');
      }, 400);
    }
  });

  
});


document.body.addEventListener('click', e => {
  if (document.body.classList.contains('blur') && e.target === document.body) {
    document.getElementById("sidebar").classList.remove("active");
    document.body.classList.remove("blur");
  }
});


const lightboxImage = document.getElementById('lightboxImage');
const lightboxVideo = document.getElementById('lightboxVideo');
const imagNameInput = document.getElementById('imagName');

function openLightbox(fullPath, isVideo) {

if(selectMode == false){
    // Update hidden input (delete / download)
    imagNameInput.value = fullPath;
 
document.getElementById('nameIMG').innerHTML =  '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" x="0" y="0" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g transform="matrix(1,0,0,1,0,15)"><path fill="#eceff1" d="M512 58.668v266.664c0 32.43-26.238 58.668-58.668 58.668H58.668c-5.336 0-10.453-.64-15.148-2.133C18.348 375.254 0 352.426 0 325.332V58.668C0 26.238 26.238 0 58.668 0h394.664C485.762 0 512 26.238 512 58.668zm0 0" opacity="1" data-original="#eceff1" class=""></path><path fill="#ffc107" d="M149.332 106.668c0 23.562-19.102 42.664-42.664 42.664C83.102 149.332 64 130.23 64 106.668 64 83.102 83.102 64 106.668 64c23.562 0 42.664 19.102 42.664 42.668zm0 0" opacity="1" data-original="#ffc107"></path><path fill="#388e3c" d="M512 276.055v49.277c0 32.43-26.238 58.668-58.668 58.668H58.668c-5.336 0-10.453-.64-15.148-2.133l260.695-260.695c14.504-14.504 38.398-14.504 52.906 0zm0 0" opacity="1" data-original="#388e3c"></path><path fill="#4caf50" d="M363.945 384H58.668c-5.336 0-10.453-.64-15.148-2.133C18.348 375.254 0 352.426 0 325.332v-6.613l122.879-122.88c14.508-14.507 38.402-14.507 52.906 0zm0 0" opacity="1" data-original="#4caf50" class=""></path></g></svg>&nbsp;' + fullPath.split('/').pop();

    if (isVideo) {
        // Show video
        lightboxImage.style.display = 'none';
        lightboxVideo.style.display = 'block';

        lightboxVideo.src = fullPath;
        lightboxVideo.load();
    } else {
        // Show image
        lightboxVideo.pause();
        lightboxVideo.src = '';
        lightboxVideo.style.display = 'none';

        lightboxImage.style.display = 'block';
        lightboxImage.src = fullPath;
    }


    document.getElementById('lightboxOverlay').classList.add('active');
    }
}




let scale = 1;       // Current zoom level
let lastScale = 1;   // Used for pinch zoom
let isPinching = false;

let posX = 0, posY = 0; // Image position
let lastX = 0, lastY = 0;
let isDragging = false;
let startX, startY;

// Get distance between two touch points
function getDistance(touches) {
  const [touch1, touch2] = touches;
  const dx = touch1.clientX - touch2.clientX;
  const dy = touch1.clientY - touch2.clientY;
  return Math.sqrt(dx * dx + dy * dy);
}

// Apply transform (zoom + pan)
function updateTransform() {
  lightboxImage.style.transform = `translate(${posX}px, ${posY}px) scale(${scale})`;
}

// --- Pinch Zoom (Touch) ---
lightboxImage.addEventListener("touchstart", (e) => {
  if (e.touches.length === 2) {
    isPinching = true;
    lastScale = scale;
    startDistance = getDistance(e.touches);
  } else if (e.touches.length === 1 && scale > 1) {
    isDragging = true;
    startX = e.touches[0].clientX - lastX;
    startY = e.touches[0].clientY - lastY;
  }
});

lightboxImage.addEventListener("touchmove", (e) => {
  if (isPinching && e.touches.length === 2) {
    const newDistance = getDistance(e.touches);
    scale = Math.min(Math.max(1, lastScale * (newDistance / startDistance)), 4);
    updateTransform();
  } else if (isDragging && e.touches.length === 1) {
    posX = e.touches[0].clientX - startX;
    posY = e.touches[0].clientY - startY;
    lastX = posX;
    lastY = posY;
    updateTransform();
  }
});

lightboxImage.addEventListener("touchend", () => {
  isPinching = false;
  isDragging = false;
});

// --- Mouse Drag for Desktop ---
lightboxImage.addEventListener("mousedown", (e) => {
  if (scale > 1) {
    isDragging = true;
    startX = e.clientX - lastX;
    startY = e.clientY - lastY;
  }
});

document.addEventListener("mousemove", (e) => {
  if (isDragging) {
    posX = e.clientX - startX;
    posY = e.clientY - startY;
    lastX = posX;
    lastY = posY;
    updateTransform();
  }
});

document.addEventListener("mouseup", () => {
  isDragging = false;
});

// --- Mouse Wheel Zoom ---
lightboxImage.addEventListener("wheel", (e) => {
  e.preventDefault();
  let zoom = scale + e.deltaY * -0.001;
  scale = Math.min(Math.max(1, zoom), 4);
  updateTransform();
});





function resetImage() {
  scale = 1;      // reset zoom
  posX = 0;       // reset position
  posY = 0;
  lastX = 0;
  lastY = 0;
  updateTransform(); // apply reset
}



const selectAllCheckbox = document.getElementById('selectAllCheckbox');
const imageCheckboxes = document.querySelectorAll('input[name="selected_images"]');
    const deletbar = document.getElementById('deletbar');

selectAllCheckbox.addEventListener('change', function() {
    imageCheckboxes.forEach(cb => cb.checked = this.checked);
const anyChecked = [...imageCheckboxes].some(c => c.checked);
    deletbar.style.display = anyChecked ? 'flex' : 'none';
});

imageCheckboxes.forEach(cb => {
    cb.addEventListener('change', function() {
        if (!this.checked) {
            selectAllCheckbox.checked = false;
        } else if (Array.from(imageCheckboxes).every(cb => cb.checked)) {
            selectAllCheckbox.checked = true;
        }
    });
});


    const selectBar = document.getElementById('selectBar');
    const gallery = document.querySelector('.gallery');
    const galleryLabels = document.querySelectorAll('.gallery label.gallery-item');
    const checkboxes = document.querySelectorAll('.gallery input[type="checkbox"]');
    let selectMode = false;



{% if images %}
    const toggleSelectBtn = document.getElementById('toggleSelectBtn');
    
    
toggleSelectBtn.addEventListener('click', () => {
    selectMode = !selectMode;
    
    
    
    document.body.classList.toggle('select-mode', selectMode);
    selectBar.style.display = selectMode ? 'flex' : 'none';
    toggleSelectBtn.innerHTML = selectMode ? '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" x="0" y="0" viewBox="0 0 64 64" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="M40.12 27.2c-7.01 0-12.71-5.7-12.71-12.71 0-2.6.78-5.09 2.25-7.21.88-1.28 1.98-2.37 3.26-3.26 2.12-1.46 4.61-2.24 7.21-2.24 7.01 0 12.71 5.7 12.71 12.71 0 2.58-.77 5.08-2.24 7.21a12.63 12.63 0 0 1-3.26 3.26 12.755 12.755 0 0 1-7.22 2.24zm0-23.42c-2.19 0-4.29.65-6.07 1.88-1.08.75-2 1.67-2.75 2.75a10.608 10.608 0 0 0-1.89 6.07c0 5.9 4.81 10.71 10.71 10.71 2.18 0 4.28-.65 6.08-1.89 1.08-.74 2-1.67 2.75-2.75 1.23-1.79 1.88-3.9 1.88-6.07 0-5.9-4.8-10.7-10.71-10.7z" fill="#ffffff" opacity="1" data-original="#000000" class=""></path><path d="M46.77 25.13c-.32 0-.63-.15-.82-.43-.31-.45-.2-1.08.25-1.39 1.08-.75 2-1.67 2.75-2.75.31-.45.94-.57 1.39-.25.45.31.57.94.25 1.39a12.71 12.71 0 0 1-3.25 3.25.96.96 0 0 1-.57.18zM46.97 19.33c-.26 0-.52-.1-.71-.29L35.58 8.35c-.22-.22-.33-.53-.28-.84s.23-.58.5-.74a8.834 8.834 0 0 1 4.33-1.14c4.88 0 8.85 3.97 8.85 8.85 0 1.52-.39 3.01-1.13 4.33-.15.27-.43.46-.74.5-.05.02-.1.02-.14.02zM38.02 7.97l8.62 8.62a6.854 6.854 0 0 0-8.62-8.62zM40.12 23.34c-4.88 0-8.85-3.97-8.85-8.85 0-1.52.39-3.02 1.13-4.34.15-.27.43-.46.74-.5.31-.05.62.06.84.28l10.69 10.69c.22.22.33.53.28.84s-.23.58-.5.74c-1.3.74-2.8 1.14-4.33 1.14zM33.6 12.38c-.22.68-.33 1.39-.33 2.11 0 3.78 3.08 6.85 6.85 6.85.72 0 1.43-.11 2.1-.33zM43.12 62.22c-1.34 0-2.61-.52-3.56-1.47l-2.29-2.29c-.89-.9-2.23-1.17-3.41-.7l-7.27 2.92c-1.71.68-3.62.6-5.26-.23a6.402 6.402 0 0 1-3.32-4.08L11.34 31.5c-.47-1.74.02-3.53 1.29-4.81a4.925 4.925 0 0 1 4.81-1.29l24.87 6.67c1.77.47 3.26 1.68 4.08 3.32s.9 3.56.22 5.27l-2.91 7.27a3.15 3.15 0 0 0 .7 3.41l2.29 2.29c.95.95 1.48 2.22 1.48 3.56s-.52 2.61-1.48 3.56c-.96.94-2.22 1.47-3.57 1.47zm-8.08-6.69c1.34 0 2.66.52 3.65 1.51l2.29 2.29c1.15 1.15 3.15 1.15 4.29 0 .57-.57.89-1.33.89-2.15s-.32-1.57-.89-2.15l-2.29-2.29a5.16 5.16 0 0 1-1.14-5.57l2.91-7.27c.47-1.18.42-2.5-.15-3.63s-1.59-1.96-2.81-2.28l-24.87-6.67c-1.04-.28-2.11.01-2.87.77s-1.05 1.84-.77 2.88l6.67 24.87a4.428 4.428 0 0 0 2.28 2.81c1.13.57 2.45.62 3.62.16l7.27-2.92c.62-.24 1.27-.36 1.92-.36z" fill="#ffffff" opacity="1" data-original="#000000" class=""></path></g></svg>' : '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" x="0" y="0" viewBox="0 0 682.667 682.667" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><defs><clipPath id="a" clipPathUnits="userSpaceOnUse"><path d="M0 512h512V0H0Z" fill="#fff" opacity="1" data-original="#fff"></path></clipPath></defs><g clip-path="url(#a)" transform="matrix(1.33333 0 0 -1.33333 0 682.667)"><path d="M0 0c6.582 11.096 10.361 24.05 10.361 37.886 0 41.069-33.293 74.362-74.362 74.362" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(319.971 296.188)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c-6.582 11.096-10.361 24.05-10.361 37.886 0 41.069 33.294 74.362 74.362 74.362" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(191.968 296.188)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c11.242 18.382 17.721 39.993 17.721 63.118 0 46.946-26.702 87.655-65.747 107.769" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(359.4 270.956)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c19.315 41.268 61.212 69.855 109.787 69.855" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(146.183 385.37)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c0-44.343 23.822-83.121 59.367-104.235" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(134.819 334.074)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c-8.087-19.673-12.546-41.22-12.546-63.809 0-45.736 18.282-87.202 47.938-117.488" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(100.577 397.883)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c-30.208 44.492-81.211 73.723-139.042 73.723-37.824 0-72.727-12.504-100.802-33.604" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(395.012 428.291)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0c9.021 20.602 14.025 43.363 14.025 67.293 0 17.391-2.643 34.164-7.55 49.94" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(409.884 266.781)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v189.409c0 13.255 10.746 24 24 24v0c13.255 0 24-10.745 24-24V3.408" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(231.97 144.237)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v24.52c0 13.254 10.746 24 24 24v0c13.255 0 24-10.746 24-24V0" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(279.97 147.645)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v14.282c0 13.255 10.746 24 24 24v0c13.255 0 24-10.745 24-24V0" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(327.97 147.645)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v.52c0 13.254 10.746 24 24 24 13.255 0 24-10.746 24-24v-21.628" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(375.97 147.645)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v-53.404a95.071 95.071 0 0 0-24-63.147" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(423.97 126.537)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v-67.477c0-24.37 8.486-47.98 24-66.774" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(231.97 144.237)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="m0 0-63.784 110.476c-6.97 12.073-2.833 27.511 9.24 34.482s27.512 2.834 34.482-9.239l15.627-27.068" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(236.098 47.32)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path><path d="M0 0v0" style="stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1" transform="translate(123.128 436.818)" fill="none" stroke="#fff" stroke-width="20" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="none" stroke-opacity="" data-original="#fff"></path></g></g></svg>';

    // Close lightbox if switching to select mode
    if (selectMode && overlay.classList.contains('active')) {
        overlay.classList.remove('active');
    }

    if (!selectMode) {
        checkboxes.forEach(cb => cb.checked = false);
    }
});
{% endif %}







// Show or hide Download button based on selection
checkboxes.forEach(cb => cb.addEventListener('change', () => {
    const anyChecked = [...checkboxes].some(c => c.checked);
    deletbar.style.display = anyChecked ? 'flex' : 'none';
}));

    // Lightbox logic
    const overlay = document.getElementById('lightboxOverlay');

    const closeBtn = document.getElementById('closeBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    
    const images = Array.from(document.querySelectorAll('input[name="selected_images"]'));
    
    let currentIndex = 0;

galleryLabels.forEach((label, index) => {
    const img = label.querySelector('img');
    img.addEventListener('click', e => {
        e.preventDefault();
        if (selectMode) {
            // Toggle selection
            const checkbox = label.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            checkbox.dispatchEvent(new Event('change'));
        } else {
            // Normal mode: open fullscreen
            currentIndex = index;
            overlay.classList.add('active');
        }
    });
});



function isVideoFile(src) {

//isVideoFile(images[currentIndex].src)
//img.filename
return src.includes('/static/Thumbnails/');


}

function isVideoFile(src) {
    return /\.(mp4|mov|avi|webm|mkv)$/i.test(src);
}

    closeBtn.onclick = () => {resetImage(); overlay.classList.remove('active');};
    prevBtn.onclick = () => {resetImage(); currentIndex = (currentIndex - 1 + images.length) % images.length; 
    openLightbox('static/Uploads/' + images[currentIndex].value,isVideoFile(images[currentIndex].value)); };
    nextBtn.onclick = () => {resetImage(); currentIndex = (currentIndex + 1) % images.length; 
    openLightbox('static/Uploads/' + images[currentIndex].value,isVideoFile(images[currentIndex].value));
    
 };



const downloadSingleBtn = document.getElementById('downloadSingleBtn');
const shareBtn = document.getElementById('shareBtn');

downloadSingleBtn.addEventListener('click', () => {
    const url = images[currentIndex].src;
    // Create a temporary link and click it to trigger download
    const a = document.createElement('a');
    a.href = url;
    a.download = url.split('/').pop();  // filename from URL
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
});

shareBtn.addEventListener('click', async () => {
    const src = images[currentIndex].src;
    const fullUrl = window.location.origin + '/' + src.replace(/^\/+/, '');

    try {
        // Fetch file as Blob
        const response = await fetch(fullUrl);
        const blob = await response.blob();

        // Detect filename
        const filename = src.split('/').pop();

        // Create File object
        const file = new File([blob], filename, { type: blob.type });

        // Check support
        if (navigator.canShare && navigator.canShare({ files: [file] })) {
            await navigator.share({
                title: 'Shared Media',
                files: [file],
            });
        } else {
            alert('File sharing not supported on this browser');
        }

    } catch (err) {
        console.error(err);
        alert('Sharing failed');
    }
});


</script>






</body>
</html>
